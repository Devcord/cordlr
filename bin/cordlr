#!/usr/bin/env node
const cordlr = require('../')
const rc = require('rc')
const log = require('log-cb')
const path = require('path')

/**
 * Create bot using command line.
 */

// Get options and set defaults
const config = rc('cordlr', {
  scripts: './scripts/*.js',
  prefix: '$',
  adminPerms: [
    'KICK_MEMBERS',
    'BAN_MEMBERS',
    'ADMINISTRATOR',
    'MANAGE_CHANNELS',
    'MANAGE_GUILD',
    'MANAGE_MESSAGES',
    'MUTE_MEMBERS',
    'DEAFEN_MEMBERS',
    'MOVE_MEMBERS',
    'MANAGE_NICKNAMES',
    'MANAGE_ROLES_OR_PERMISSIONS'
  ]
})

// Print help screen.
if (config.help) {
  const fs = require('fs')
  console.log(fs.readFileSync(path.join(__dirname, 'usage.txt')))
  process.exit(0)
}

// Print version screen.
if (config.version) {
  console.log(require('../package.json').version)
  process.exit(0)
}

// Create bot.
const bot = cordlr(config)

// Log done message.
bot.on('done', hasScripts => {
  log('Loaded and authenticated the bot.')()
  if (!hasScripts) log('(Warning: no scripts)')()
})
